**<div align="center"><h2>Морозова Юлия, OTUS, группа Postgre-DBA-2023-11</h2></div>**

**<div align=center><h3>Домашнее задание №4 по теме:</h3></div>**
**<div align=center><h3>«Логический уровень PostgreSQL. Работа с базами данных, пользователями и правами.»</h3></div>**

***

**<h3>Цель:
<br>создание новой базы данных, схемы и таблицы
<br>создание роли для чтения данных из созданной схемы созданной базы данных
<br>создание роли для чтения и записи из созданной схемы созданной базы данных.</h3>**

***
**Выполнение:**

**1. создайте новый кластер PostgresSQL 14**

Согласно заданию, создаю новый кластер PostgresSQL 14 версии. Буду устанавливать на одной из своих ВМ в ЯО, где уже стоит  кластер PostgresSQL 15 версии.
Устанавливаю командой:

``sudo apt install postgresql-14``

логинюсь пользователем postgres ``sudo su postgres`` и проверяю кластеры командой ``pg_lsclusters`` , все ок: порт 5432 версия 15я, а на порту 5433 - версия PostgresSQL 14:

  ![1_1](https://github.com/Y-M-Morozova/4_homework_Morozova_Yulia/assets/153178571/15fcb9ff-6c9e-4ea0-a278-2a489fdcebf9)


**2. зайдите в созданный кластер под пользователем postgres**


создайте новую базу данных testdb
зайдите в созданную базу данных под пользователем postgres
создайте новую схему testnm
создайте новую таблицу t1 с одной колонкой c1 типа integer
вставьте строку со значением c1=1
создайте новую роль readonly
дайте новой роли право на подключение к базе данных testdb
дайте новой роли право на использование схемы testnm
дайте новой роли право на select для всех таблиц схемы testnm
создайте пользователя testread с паролем test123
дайте роль readonly пользователю testread
зайдите под пользователем testread в базу данных testdb
сделайте select * from t1;
получилось? (могло если вы делали сами не по шпаргалке и не упустили один существенный момент про который позже)
напишите что именно произошло в тексте домашнего задания
у вас есть идеи почему? ведь права то дали?
посмотрите на список таблиц
подсказка в шпаргалке под пунктом 20
а почему так получилось с таблицей (если делали сами и без шпаргалки то может у вас все нормально)
вернитесь в базу данных testdb под пользователем postgres
удалите таблицу t1
создайте ее заново но уже с явным указанием имени схемы testnm
вставьте строку со значением c1=1
зайдите под пользователем testread в базу данных testdb
сделайте select * from testnm.t1;
получилось?
есть идеи почему? если нет - смотрите шпаргалку
как сделать так чтобы такое больше не повторялось? если нет идей - смотрите шпаргалку
сделайте select * from testnm.t1;
получилось?
есть идеи почему? если нет - смотрите шпаргалку
сделайте select * from testnm.t1;
получилось?
ура!
теперь попробуйте выполнить команду create table t2(c1 integer); insert into t2 values (2);
а как так? нам же никто прав на создание таблиц и insert в них под ролью readonly?
есть идеи как убрать эти права? если нет - смотрите шпаргалку
если вы справились сами то расскажите что сделали и почему, если смотрели шпаргалку - объясните что сделали и почему выполнив указанные в ней команды
теперь попробуйте выполнить команду create table t3(c1 integer); insert into t2 values (2);
расскажите что получилось и почему
